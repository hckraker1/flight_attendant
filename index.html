<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø­Ø§Ø¶Ø±Ø© Ù‚Ø³Ù… Ø§Ù„Ø¶ÙŠØ§ÙØ© Ø§Ù„Ø¬ÙˆÙŠØ© - Ø§ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø³ÙƒØ§ÙŠ Ø§ÙŠØ¬Ù„Ø²</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px 20px; text-align: center; }
        .header .academy { font-size: 1.4em; font-weight: bold; margin: 10px 0; letter-spacing: 1px; }
        .header h1 { font-size: 2.5em; margin: 15px 0; }
        .header .cap { font-size: 1.2em; font-weight: bold; letter-spacing: 0.5px; }
        .header .supervisor { font-size: 1.2em; font-weight: bold; color: #ffffff; }
        .cap-supervisor { display: flex; justify-content: center; gap: 20px; margin-top: 15px; }
        .content { padding: 40px; }
        .section { display: none; }
        .section.active { display: block; }
        .lesson-content { line-height: 1.8; color: #333; }
        .lesson-content h2 { color: #667eea; margin: 25px 0 15px 0; font-size: 1.8em; }
        .lesson-content h3 { color: #764ba2; margin: 20px 0 10px 0; }
        .lesson-content ul { margin: 15px 0 15px 30px; }
        .emoji { font-size: 2.5em; margin: 20px 0; text-align: center; }
        .timer-section { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 25px; display: flex; justify-content: space-between; }
        .timer { font-size: 2em; font-weight: bold; }
        .timer.warning { color: #ffeb3b; animation: blink 1s infinite; }
        .timer.danger { color: #f44336; animation: blink 0.5s infinite; }
        @keyframes blink { 0%, 50% { opacity: 1; } 51%, 100% { opacity: 0.5; } }
        .progress { text-align: center; color: #667eea; font-weight: bold; margin-bottom: 20px; }
        .progress-bar { width: 100%; height: 8px; background: #e0e0e0; border-radius: 4px; margin-top: 10px; overflow: hidden; }
        .progress-bar-fill { height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); width: 0%; transition: width 0.3s; }
        .quiz-question { background: #f8f9ff; border-right: 4px solid #667eea; padding: 25px; margin-bottom: 25px; border-radius: 10px; }
        .quiz-question h3 { color: #667eea; margin-bottom: 20px; font-size: 1.1em; }
        .question-type { font-size: 0.9em; color: #764ba2; font-weight: bold; margin-bottom: 10px; }
        .options { display: flex; flex-direction: column; gap: 12px; }
        .option { padding: 15px; background: white; border: 2px solid #e0e0e0; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .option:hover:not(.disabled) { border-color: #667eea; background: #f0f2ff; }
        .option.correct { border-color: #4caf50; background: #4caf50; color: white; }
        .option.incorrect { border-color: #f44336; background: #f44336; color: white; }
        .option.disabled { cursor: not-allowed; opacity: 0.7; }
        .feedback { margin-top: 15px; padding: 15px; border-radius: 8px; display: none; font-size: 1.05em; }
        .feedback.show { display: block; }
        .feedback.correct { background: #c8e6c9; color: #1b5e20; border-left: 4px solid #4caf50; }
        .feedback.incorrect { background: #ffcdd2; color: #b71c1c; border-left: 4px solid #f44336; }
        .nav-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 40px; }
        button { padding: 15px 30px; font-size: 1.1em; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4); }
        .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }
        .btn-secondary { background: #e0e0e0; color: #333; }
        .btn-danger { background: #f44336; color: white; }
        .btn-success { background: #4caf50; color: white; }
        .btn-warning { background: #ff9800; color: white; }
        .score-board { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 10px; text-align: center; margin: 20px 0; }
        .score-board h2 { font-size: 2em; margin-bottom: 10px; }
        .score-details { background: #f8f9ff; padding: 20px; border-radius: 10px; margin: 20px 0; }
        .start-screen { text-align: center; }
        .start-screen h2 { color: #667eea; margin: 20px 0; }
        .info-box { background: #e3f2fd; border-right: 4px solid #667eea; padding: 20px; border-radius: 8px; margin: 20px 0; }
        
        /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© */
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
        .form-control { width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em; }
        .form-control:focus { border-color: #667eea; outline: none; }
        .login-form { max-width: 400px; margin: 0 auto; }
        .student-info { background: #e3f2fd; padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .student-info h3 { color: #667eea; margin-bottom: 10px; }
        .teacher-panel { text-align: center; }
        .teacher-panel h2 { color: #667eea; margin-bottom: 20px; }
        .student-list { margin-top: 30px; }
        .student-card { background: #f8f9ff; border-radius: 10px; padding: 20px; margin-bottom: 15px; border-right: 4px solid #667eea; position: relative; }
        .student-card h4 { color: #667eea; margin-bottom: 10px; }
        .student-card p { margin: 5px 0; }
        .student-actions { display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap; }
        .question-details { margin-top: 15px; }
        .question-result { padding: 10px; margin: 5px 0; border-radius: 5px; }
        .question-result.correct { background: #c8e6c9; color: #1b5e20; }
        .question-result.incorrect { background: #ffcdd2; color: #b71c1c; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0; }
        .stat-box { background: #f8f9ff; padding: 15px; border-radius: 8px; text-align: center; }
        .stat-box h3 { color: #667eea; margin-bottom: 10px; }
        .stat-box .number { font-size: 2em; font-weight: bold; }
        .back-link { text-align: center; margin-top: 20px; }
        .back-link a { color: #667eea; text-decoration: none; font-weight: bold; }
        .error-message { color: #f44336; margin-top: 5px; font-size: 0.9em; }
        .success-message { color: #4caf50; margin-top: 5px; font-size: 0.9em; }
        .edit-form { background: #f8f9ff; padding: 20px; border-radius: 10px; margin: 15px 0; border: 2px solid #667eea; }
        .edit-form h4 { color: #667eea; margin-bottom: 15px; }
        .action-buttons { display: flex; gap: 10px; justify-content: center; margin-top: 20px; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 10px; width: 90%; max-width: 500px; }
        .modal-buttons { display: flex; gap: 15px; justify-content: center; margin-top: 20px; }
        .no-data { text-align: center; color: #666; padding: 40px; font-size: 1.1em; }
        .question-text { font-weight: bold; margin-bottom: 10px; color: #333; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="academy">Ø§ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø³ÙƒØ§ÙŠ Ø§ÙŠØ¬Ù„Ø²</div>
            <h1>âœˆï¸ Ø§Ù…ØªØ­Ø§Ù† Ø¹Ø§Ù„Ù… Ø§Ù„Ø·ÙŠØ±Ø§Ù†</h1>
            <div class="academy">Ù‚Ø³Ù… Ø§Ù„Ø¶ÙŠØ§ÙØ© Ø§Ù„Ø¬ÙˆÙŠØ©</div>
            <p style="margin-top: 15px; font-size: 0.95em;">30 Ø³Ø¤Ø§Ù„ - 30 Ø¯Ù‚ÙŠÙ‚Ø©</p>
            <div class="cap">CAP: Peter</div>
            <div class="supervisor">ØªØ­Øª Ø§Ø´Ø±Ø§Ù: CAP: Basmala</div>
        </div>
        
        <div class="content">
            <!-- ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨ -->
            <div id="studentRegistration" class="section active">
                <div class="start-screen">
                    <h2>ğŸ“ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨</h2>
                    <div class="info-box">
                        <strong>ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</strong>
                        <div style="margin-top: 10px;">âœ“ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</div>
                        <div>âœ“ ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù…ØªØ­Ø§Ù† ØºÙŠØ± Ù…ÙƒØ±Ø±</div>
                        <div>âœ“ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ø¨Ø¯ÙˆÙ† Ø§Ù„ØªØ³Ø¬ÙŠÙ„</div>
                        <div>âœ“ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù„ÙƒÙ„ Ø·Ø§Ù„Ø¨</div>
                    </div>
                    <div class="login-form">
                        <div class="form-group">
                            <label for="studentName">Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
                            <input type="text" id="studentName" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
                            <div id="nameError" class="error-message" style="display: none;">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</div>
                        </div>
                        <div class="form-group">
                            <label for="examNumber">Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</label>
                            <input type="number" id="examNumber" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†">
                            <div id="numberError" class="error-message" style="display: none;">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù…ØªØ­Ø§Ù† ØµØ­ÙŠØ­</div>
                            <div id="duplicateError" class="error-message" style="display: none;">Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹</div>
                        </div>
                        <div class="nav-buttons">
                            <button class="btn-primary" onclick="registerStudent()">ØªØ³Ø¬ÙŠÙ„ ÙˆØ¨Ø¯Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
                        </div>
                    </div>
                    <div class="back-link">
                        <a href="#" onclick="showSection('teacherLogin')">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³</a>
                    </div>
                </div>
            </div>
            
            <!-- ØµÙØ­Ø© Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³ -->
            <div id="teacherLogin" class="section">
                <div class="start-screen">
                    <h2>ğŸ‘¨â€ğŸ« Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³</h2>
                    <div class="login-form">
                        <div class="form-group">
                            <label for="teacherUsername">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                            <input type="text" id="teacherUsername" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
                        </div>
                        <div class="form-group">
                            <label for="teacherPassword">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                            <input type="password" id="teacherPassword" class="form-control" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                        </div>
                        <div class="nav-buttons">
                            <button class="btn-primary" onclick="teacherLogin()">Ø¯Ø®ÙˆÙ„</button>
                            <button class="btn-secondary" onclick="showSection('studentRegistration')">Ø±Ø¬ÙˆØ¹</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ØµÙØ­Ø© ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³ -->
            <div id="teacherPanel" class="section">
                <div class="teacher-panel">
                    <h2>ğŸ“Š Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯Ø±Ø³</h2>
                    
                    <div class="stats-grid">
                        <div class="stat-box">
                            <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨</h3>
                            <div class="number" id="totalStudents">0</div>
                        </div>
                        <div class="stat-box">
                            <h3>Ù…ØªÙˆØ³Ø· Ø§Ù„Ù†ØªØ§Ø¦Ø¬</h3>
                            <div class="number" id="averageScore">0%</div>
                        </div>
                        <div class="stat-box">
                            <h3>Ø£Ø¹Ù„Ù‰ Ù†ØªÙŠØ¬Ø©</h3>
                            <div class="number" id="highestScore">0%</div>
                        </div>
                        <div class="stat-box">
                            <h3>Ø£Ù‚Ù„ Ù†ØªÙŠØ¬Ø©</h3>
                            <div class="number" id="lowestScore">0%</div>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn-warning" onclick="exportData()">ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                        <button class="btn-danger" onclick="clearAllData()">ğŸ—‘ï¸ Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                    </div>
                    
                    <div class="student-list" id="studentList">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø¨Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨ -->
                    </div>
                    
                    <div class="nav-buttons">
                        <button class="btn-secondary" onclick="showSection('teacherLogin')">Ø±Ø¬ÙˆØ¹</button>
                    </div>
                </div>
            </div>
            
            <!-- ØµÙØ­Ø© ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† -->
            <div id="lesson" class="section">
                <div class="student-info">
                    <h3>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨:</h3>
                    <p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> <span id="displayStudentName"></span></p>
                    <p><strong>Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</strong> <span id="displayExamNumber"></span></p>
                    <p><strong>ÙˆÙ‚Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> <span id="displayRegistrationTime"></span></p>
                </div>
                
                <div class="lesson-content">
                    <h2>ğŸ“š ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</h2>
                    <div class="emoji">âœˆï¸</div>
                    <h3>Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…:</h3>
                    <ul>
                        <li><strong>Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©:</strong> ÙƒÙ„ Ø·Ø§Ù„Ø¨ ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ ØªØ±ØªÙŠØ¨ Ù…Ø®ØªÙ„Ù Ù„Ù„Ø£Ø³Ø¦Ù„Ø©</li>
                        <li><strong>Ø®ÙŠØ§Ø±Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©:</strong> ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ÙŠØªØºÙŠØ± Ù„ÙƒÙ„ Ø·Ø§Ù„Ø¨</li>
                        <li><strong>Ù†Ø¸Ø§Ù… Ø¢Ù…Ù†:</strong> Ù…Ù†Ø¹ Ø§Ù„ØºØ´ ÙˆØ§Ù„ØªØ´Ø§Ø¨Ù‡ Ø¨ÙŠÙ† Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</li>
                    </ul>
                    <h3>Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©:</h3>
                    <ul>
                        <li><strong>Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯:</strong> Ø§Ø®ØªØ± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© (Ø£ØŒ Ø¨ØŒ Ø¬ØŒ Ø¯)</li>
                        <li><strong>ØµØ­ Ø£Ùˆ Ø®Ø·Ø£:</strong> Ø­Ø¯Ø¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© ØµØ­ÙŠØ­Ø© Ø£Ù… Ø®Ø§Ø·Ø¦Ø©</li>
                        <li><strong>Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¹Ø¨Ø§Ø±Ø§Øª:</strong> Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¬Ù…Ù„Ø© Ø¨Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©</li>
                        <li><strong>ØªØ¹Ø±ÙŠÙØ§Øª:</strong> Ø§Ø®ØªØ± Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ù…ÙÙ‡ÙˆÙ…</li>
                    </ul>
                    <h3>Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</h3>
                    <ul>
                        <li>ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© = Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø©</li>
                        <li>ÙƒÙ„ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø© = -0.5 Ù†Ù‚Ø·Ø©</li>
                        <li>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø­Ø¯Ø¯: 30 Ø¯Ù‚ÙŠÙ‚Ø©</li>
                        <li>Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: 30 Ù†Ù‚Ø·Ø©</li>
                    </ul>
                    <div class="nav-buttons">
                        <button class="btn-primary" onclick="goToStart()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</button>
                        <button class="btn-secondary" onclick="showSection('studentRegistration')">Ø±Ø¬ÙˆØ¹</button>
                    </div>
                </div>
            </div>
            
            <!-- ØµÙØ­Ø© Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† -->
            <div id="startScreen" class="section">
                <div class="start-screen">
                    <h2>ğŸ“ Ù‡Ù„ Ø§Ù†Øª Ù…Ø³ØªØ¹Ø¯ØŸ</h2>
                    <div class="info-box">
                        <strong>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</strong>
                        <div style="margin-top: 10px;">âœ“ 30 Ø³Ø¤Ø§Ù„ Ù…ØªÙ†ÙˆØ¹</div>
                        <div>âœ“ 30 Ø¯Ù‚ÙŠÙ‚Ø© ÙˆÙ‚Øª</div>
                        <div>âœ“ Ù†Ø¸Ø§Ù… Ø®ØµÙ…</div>
                        <div>âœ“ ØªØ±ÙƒÙŠØ² Ø¶Ø±ÙˆØ±ÙŠ</div>
                        <div>âœ“ Ø£Ø³Ø¦Ù„Ø© ÙˆØ®ÙŠØ§Ø±Ø§Øª Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©</div>
                    </div>
                    <div class="nav-buttons">
                        <button class="btn-primary" onclick="startQuiz()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
                        <button class="btn-secondary" onclick="backToLesson()">Ø§Ù„Ø¹ÙˆØ¯Ø©</button>
                    </div>
                </div>
            </div>
            
            <!-- ØµÙØ­Ø© Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† -->
            <div id="quiz" class="section">
                <div class="timer-section">
                    <div>
                        <div style="font-size: 0.9em;">Ø§Ù„ÙˆÙ‚Øª:</div>
                        <div id="timer" class="timer">30:00</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 0.9em;">Ø§Ù„Ø¯Ø±Ø¬Ø©</div>
                        <div id="currentScore" style="font-size: 1.5em; font-weight: bold;">0</div>
                    </div>
                </div>
                
                <div class="progress">
                    <span id="progressText">Ø§Ù„Ø³Ø¤Ø§Ù„ 1 Ù…Ù† 30</span>
                    <div class="progress-bar">
                        <div class="progress-bar-fill" id="progressBar"></div>
                    </div>
                </div>
                
                <div id="quizContainer"></div>
                
                <div id="results" style="display: none;">
                    <div class="score-board">
                        <h2 id="resultTitle">Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†</h2>
                        <p id="finalScore"></p>
                        <p id="scorePercentage"></p>
                    </div>
                    <div class="score-details">
                        <p><strong>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©:</strong> <span id="correctAnswers">0</span></p>
                        <p><strong>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø®Ø§Ø·Ø¦Ø©:</strong> <span id="wrongAnswers">0</span></p>
                        <p><strong>Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©:</strong> <span id="totalPoints">0</span>/30</p>
                    </div>
                    <div class="nav-buttons">
                        <button class="btn-secondary" onclick="showSection('studentRegistration')">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ£ÙƒÙŠØ¯ -->
    <div id="confirmModal" class="modal">
        <div class="modal-content">
            <h3 id="modalTitle">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©</h3>
            <p id="modalMessage">Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ ØªÙ†ÙÙŠØ° Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©ØŸ</p>
            <div class="modal-buttons">
                <button class="btn-danger" id="confirmAction">Ù†Ø¹Ù…</button>
                <button class="btn-secondary" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        </div>
    </div>

    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        const allQuestions = [
            { type: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯", q: "Ù…Ø§Ø°Ø§ ØªØ±Ù…Ø² Ø£Ø³Ø·ÙˆØ±Ø© Ø¥ÙŠÙƒØ§Ø±ÙˆØ³ ÙÙŠ ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·ÙŠØ±Ø§Ù†ØŸ", opts: ["Ø§Ù„Ø±ØºØ¨Ø© ÙÙŠ ÙƒØ³Ø± Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© ÙˆØ§Ù„Ø·Ù…ÙˆØ­ Ø§Ù„Ø¥Ù†Ø³Ø§Ù†ÙŠ Ù†Ø­Ùˆ Ø§Ù„Ø·ÙŠØ±Ø§Ù†", "Ø§Ù„Ø®ÙˆÙ Ù…Ù† Ø§Ù„Ø³Ù‚ÙˆØ· ÙˆØ§Ù„Ø§Ø¨ØªØ¹Ø§Ø¯ Ø¹Ù† Ø§Ù„Ù…Ø®Ø§Ø·Ø±", "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ù„Ø£ØºØ±Ø§Ø¶ Ø¹Ø³ÙƒØ±ÙŠØ©", "Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø­Ø¯ÙŠØ«Ø© ÙÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ‚"], ans: 0 },
            { type: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯", q: "Ù…Ù† Ù‡Ùˆ Ø§Ù„Ù…Ø®ØªØ±Ø¹ Ø§Ù„Ø°ÙŠ Ø±Ø³Ù… ØªØµØ§Ù…ÙŠÙ… Ø£ÙˆÙ„ÙŠØ© Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø®Ù„Ø§Ù„ Ø¹ØµØ± Ø§Ù„Ù†Ù‡Ø¶Ø©ØŸ", opts: ["Ø¹Ø¨Ø§Ø³ Ø¨Ù† ÙØ±Ù†Ø§Ø³", "Ù„ÙŠÙˆÙ†Ø§Ø±Ø¯Ùˆ Ø¯Ø§ÙÙ†Ø´ÙŠ", "Ø±Ø§ÙŠØª Ø¨Ø±Ø§Ø²Ø±Ø²", "Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ù…ÙˆÙ†ØºÙˆÙ„ÙÙŠÙŠÙ‡"], ans: 1 },
            { type: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯", q: "Ù…Ù† Ù‚Ø§Ù… Ø¨Ø£ÙˆÙ„ Ø±Ø­Ù„Ø© Ø¨Ø¨Ø§Ù„ÙˆÙ† Ù‡ÙˆØ§Ø¦ÙŠ Ù…Ø³ÙŠÙ‘Ø± Ø¹Ø§Ù… 1783ØŸ", opts: ["Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ø±Ø§ÙŠØª", "Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ù…ÙˆÙ†ØºÙˆÙ„ÙÙŠÙŠÙ‡", "Ù„ÙŠÙˆÙ†Ø§Ø±Ø¯Ùˆ Ø¯Ø§ÙÙ†Ø´ÙŠ", "Ø¹Ø¨Ø§Ø³ Ø¨Ù† ÙØ±Ù†Ø§Ø³"], ans: 1 },
            { type: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯", q: "Ù…ØªÙ‰ Ù†Ø¬Ø­ Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ø±Ø§ÙŠØª ÙÙŠ Ø£ÙˆÙ„ Ø±Ø­Ù„Ø© Ø·ÙŠØ±Ø§Ù† Ù…Ø¯ÙÙˆØ¹ ÙˆÙ…ØªØ­ÙƒÙ… Ø¨Ù‡ØŸ", opts: ["Ø¹Ø§Ù… 1895", "Ø¹Ø§Ù… 1903", "Ø¹Ø§Ù… 1920", "Ø¹Ø§Ù… 1945"], ans: 1 },
            { type: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯", q: "Ù…Ø§ Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ø°ÙŠ ÙŠÙ…Ø«Ù„ Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙ†Ø¸ÙŠÙ… Ø­Ø±ÙƒØ© Ø§Ù„Ø·Ø§Ø¦Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø¬ÙˆØŸ", opts: ["Ø§Ù„Ù…Ø·Ø§Ø±Ø§Øª", "Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø¬ÙˆÙŠØ© (ATC)", "Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª ÙˆØ§Ù„Ø¯ÙØ¹", "Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª Ø§Ù„Ø·ÙŠØ±Ø§Ù†"], ans: 1 },
            { type: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯", q: "Ø£ÙŠ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© ÙŠÙØ¹Ø¯ Ù…Ù† Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø±Ø§Øª Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ© ÙÙŠ Ù…Ø¬Ø§Ù„ Ø§Ù„Ø·ÙŠØ±Ø§Ù†ØŸ", opts: ["Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù‚Ø§Ø¹Ø¯ ÙÙ‚Ø·", "Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙˆØ§Ø¯ Ø®ÙÙŠÙØ© Ø§Ù„ÙˆØ²Ù† ÙˆÙ…ØªÙŠÙ†Ø©", "ØªÙ‚Ù„ÙŠÙ„ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª", "Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø·ÙŠØ§Ø± Ø§Ù„Ø¢Ù„ÙŠ"], ans: 1 },
            { type: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯", q: "Ù…Ø§ Ù†Ø³Ø¨Ø© Ø§Ù†Ø¨Ø¹Ø§Ø«Ø§Øª Ø«Ø§Ù†ÙŠ Ø£ÙƒØ³ÙŠØ¯ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ† Ø§Ù„ØªÙŠ ÙŠØ³Ø¨Ø¨Ù‡Ø§ Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø¹Ø§Ù„Ù…ÙŠÙ‹Ø§ØŸ", opts: ["1%", "2â€“3%", "5â€“7%", "Ø£ÙƒØ«Ø± Ù…Ù† 10%"], ans: 1 },
            { type: "Ø§Ø®ØªÙŠØ§Ø± Ù…Ù† Ù…ØªØ¹Ø¯Ø¯", q: "Ù…Ø§ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø¨ÙŠØ¦ÙŠ Ø§Ù„Ø°ÙŠ ØªØ³Ø¹Ù‰ Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø¥Ù„Ù‰ ØªØ­Ù‚ÙŠÙ‚Ù‡ Ø¨Ø­Ù„ÙˆÙ„ Ø¹Ø§Ù… 2050ØŸ", opts: ["Ù…Ø¶Ø§Ø¹ÙØ© Ø¹Ø¯Ø¯ Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ø¬ÙˆÙŠØ©", "Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ ØµØ§ÙÙŠ Ø§Ù†Ø¨Ø¹Ø§Ø«Ø§Øª ØµÙØ±ÙŠØ© (Net Zero)", "Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø±Ø­Ù„Ø§Øª Ø§Ù„Ù‚ØµÙŠØ±Ø©", "Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø·Ø§Ø¦Ø±Ø§Øª Ø¨Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø±ÙŠ"], ans: 1 },
            { type: "ØµØ­ Ø£Ùˆ Ø®Ø·Ø£", q: "Ø£Ø³Ø·ÙˆØ±Ø© Ø¥ÙŠÙƒØ§Ø±ÙˆØ³ ØªÙ…Ø«Ù„ Ø§Ù„Ø®ÙˆÙ Ù…Ù† Ø§Ù„Ø·ÙŠØ±Ø§Ù† ÙˆØ§Ù„ØªÙ‚ÙŠØ¯ Ø¨Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø£Ø±Ø¶", opts: ["ØµØ­", "Ø®Ø·Ø£"], ans: 1 },
            { type: "ØµØ­ Ø£Ùˆ Ø®Ø·Ø£", q: "Ø§Ø³ØªØ®Ø¯Ù… Ù„ÙŠÙˆÙ†Ø§Ø±Ø¯Ùˆ Ø¯Ø§ÙÙ†Ø´ÙŠ Ø§Ù„Ø£Ø¬Ù†Ø­Ø© Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© ÙÙŠ Ø§Ø®ØªØ±Ø§Ø¹Ø§ØªÙ‡ Ù„ØªÙ‚Ù„ÙŠØ¯ Ø­Ø±ÙƒØ© Ø§Ù„Ø·ÙŠÙˆØ±", opts: ["ØµØ­", "Ø®Ø·Ø£"], ans: 0 },
            { type: "ØµØ­ Ø£Ùˆ Ø®Ø·Ø£", q: "Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ù…ÙˆÙ†ØºÙˆÙ„ÙÙŠÙŠÙ‡ Ù†ÙØ°Ø§ Ø£ÙˆÙ„ Ø±Ø­Ù„Ø© Ø·ÙŠØ±Ø§Ù† Ø¨Ù…Ø­Ø±Ùƒ Ù†ÙØ§Ø«", opts: ["ØµØ­", "Ø®Ø·Ø£"], ans: 1 },
            { type: "ØµØ­ Ø£Ùˆ Ø®Ø·Ø£", q: "Ù†Ø¸Ø§Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø¬ÙˆÙŠØ© ÙŠÙ‡Ø¯Ù Ø¥Ù„Ù‰ Ø¶Ù…Ø§Ù† Ø§Ù„Ø³Ù„Ø§Ù…Ø© ÙˆØ§Ù„ÙƒÙØ§Ø¡Ø© ÙÙŠ Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¬ÙˆÙŠ", opts: ["ØµØ­", "Ø®Ø·Ø£"], ans: 0 },
            { type: "ØµØ­ Ø£Ùˆ Ø®Ø·Ø£", q: "Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© ØªØ¹ØªØ¨Ø± Ù…Ù† Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø­Ø¯ÙŠØ«Ø© ÙÙŠ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ù…Ø³ØªØ¯Ø§Ù…", opts: ["ØµØ­", "Ø®Ø·Ø£"], ans: 0 },
            { type: "ØµØ­ Ø£Ùˆ Ø®Ø·Ø£", q: "Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ù„Ø§ ÙŠØ³Ø§Ù‡Ù… Ø¥Ø·Ù„Ø§Ù‚Ù‹Ø§ ÙÙŠ Ø§Ù†Ø¨Ø¹Ø§Ø«Ø§Øª Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†", opts: ["ØµØ­", "Ø®Ø·Ø£"], ans: 1 },
            { type: "ØµØ­ Ø£Ùˆ Ø®Ø·Ø£", q: "Ù…Ù‡Ù†Ø¯Ø³Ùˆ Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆÙ…Ø±Ø§Ù‚Ø¨Ùˆ Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø¬ÙˆÙŠØ© Ù…Ù† Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙ‚Ù†ÙŠØ© ÙÙŠ Ù…Ø¬Ø§Ù„ Ø§Ù„Ø·ÙŠØ±Ø§Ù†", opts: ["ØµØ­", "Ø®Ø·Ø£"], ans: 0 },
            { type: "Ø¥ÙƒÙ…Ø§Ù„", q: "ØªÙ…Ø«Ù„ Ø£Ø³Ø·ÙˆØ±Ø© _____ Ø±Ù…Ø²Ù‹Ø§ Ù„Ù„Ø±ØºØ¨Ø© ÙÙŠ ÙƒØ³Ø± Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© ÙˆØªØ­Ù‚ÙŠÙ‚ Ø­Ù„Ù… Ø§Ù„Ø·ÙŠØ±Ø§Ù†", opts: ["Ø¥ÙŠÙƒØ§Ø±ÙˆØ³", "Ù„ÙŠÙˆÙ†Ø§Ø±Ø¯Ùˆ", "Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ø±Ø§ÙŠØª", "Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ù…ÙˆÙ†ØºÙˆÙ„ÙÙŠÙŠÙ‡"], ans: 0 },
            { type: "Ø¥ÙƒÙ…Ø§Ù„", q: "ÙŠÙØ¹Ø¯ _____ Ù…Ù† Ø£ÙˆØ§Ø¦Ù„ Ù…Ù† ØµÙ…Ù…ÙˆØ§ Ù†Ù…Ø§Ø°Ø¬ Ø·ÙŠØ±Ø§Ù† ÙÙŠ Ø¹ØµØ± Ø§Ù„Ù†Ù‡Ø¶Ø©", opts: ["Ø¹Ø¨Ø§Ø³ Ø¨Ù† ÙØ±Ù†Ø§Ø³", "Ù„ÙŠÙˆÙ†Ø§Ø±Ø¯Ùˆ Ø¯Ø§ÙÙ†Ø´ÙŠ", "Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ø±Ø§ÙŠØª", "Ù…ÙˆÙ†ØºÙˆÙ„ÙÙŠÙŠÙ‡"], ans: 1 },
            { type: "Ø¥ÙƒÙ…Ø§Ù„", q: "Ù‚Ø§Ù… Ø§Ù„Ø£Ø®ÙˆØ§Ù† _____ Ø¨Ø£ÙˆÙ„ Ø±Ø­Ù„Ø© Ø¨Ø¨Ø§Ù„ÙˆÙ† Ù‡ÙˆØ§Ø¦ÙŠ Ø¹Ø§Ù… 1783", opts: ["Ø±Ø§ÙŠØª", "Ù…ÙˆÙ†ØºÙˆÙ„ÙÙŠÙŠÙ‡", "ÙØ±Ù†Ø§Ø³", "Ø¯Ø§ÙÙ†Ø´ÙŠ"], ans: 1 },
            { type: "Ø¥ÙƒÙ…Ø§Ù„", q: "Ø£ÙˆÙ„ Ø·ÙŠØ±Ø§Ù† Ù…Ø¯ÙÙˆØ¹ ÙˆÙ…ØªØ­ÙƒÙ… Ø¨Ù‡ ØªÙ… Ø¹Ø§Ù… _____ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø£Ø®ÙˆÙŠÙ† Ø±Ø§ÙŠØª", opts: ["1895", "1903", "1920", "1945"], ans: 1 },
            { type: "Ø¥ÙƒÙ…Ø§Ù„", q: "ÙŠØªÙƒÙˆÙ† Ù†Ø¸Ø§Ù… Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ù…Ù† Ø£Ø±Ø¨Ø¹Ø© Ø¹Ù†Ø§ØµØ± Ø±Ø¦ÙŠØ³ÙŠØ© Ù‡ÙŠ: Ø§Ù„Ø·Ø§Ø¦Ø±Ø§ØªØŒ _____ ØŒ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø¬ÙˆÙŠØ©ØŒ ÙˆØ§Ù„Ù…Ø­Ø±ÙƒØ§Øª", opts: ["Ø§Ù„Ù…Ø·Ø§Ø±Ø§Øª", "Ø§Ù„ÙÙ†Ø§Ø¯Ù‚", "Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª", "Ø§Ù„Ù‚Ø·Ø§Ø±Ø§Øª"], ans: 0 },
            { type: "Ø¥ÙƒÙ…Ø§Ù„", q: "ÙŠÙØ¹Ø¯ Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ù…Ù† Ø£Ù‡Ù… Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª Ù„Ù„Ø§Ù‚ØªØµØ§Ø¯ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù…Ù† Ø®Ù„Ø§Ù„ Ø¯Ø¹Ù…Ù‡ _____ ÙˆØ§Ù„Ø³ÙŠØ§Ø­Ø©", opts: ["Ø§Ù„Ø³ÙŠØ§Ø³Ø©", "Ø§Ù„ØªØ¬Ø§Ø±Ø©", "Ø§Ù„ØµÙ†Ø§Ø¹Ø©", "Ø§Ù„Ø²Ø±Ø§Ø¹Ø©"], ans: 1 },
            { type: "Ø¥ÙƒÙ…Ø§Ù„", q: "Ù…Ù† Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø±Ø§Øª Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ© ÙÙŠ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ø­Ø¯ÙŠØ«Ø© _____ ÙˆÙˆÙ‚ÙˆØ¯ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ù…Ø³ØªØ¯Ø§Ù…", opts: ["Ø§Ù„Ø£ØªÙ…ØªØ© ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ", "Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©", "Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ÙˆØ²Ù†", "ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø£Ù…Ø§Ù†"], ans: 0 },
            { type: "Ø¥ÙƒÙ…Ø§Ù„", q: "ØªØ³Ø¹Ù‰ Ø´Ø±ÙƒØ§Øª Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø¥Ù„Ù‰ ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø£Ø«Ø± Ø§Ù„Ø¨ÙŠØ¦ÙŠ Ù…Ù† Ø®Ù„Ø§Ù„ Ø¨Ø±Ø§Ù…Ø¬ _____ ÙˆØ§Ù„Ø§Ù†Ø¨Ø¹Ø§Ø«Ø§Øª Ø§Ù„ØµÙØ±ÙŠØ©", opts: ["ØªØ¹ÙˆÙŠØ¶ Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†", "Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø§Ù†Ø¨Ø¹Ø§Ø«Ø§Øª", "ØªÙˆØ³ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª", "ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØµÙŠØ§Ù†Ø©"], ans: 0 },
            { type: "ØªØ¹Ø±ÙŠÙ", q: "Ù…Ø§ Ø§Ù„ØªØ¹Ø±ÙŠÙ Ø§Ù„ØµØ­ÙŠØ­ Ù„Ù„Ø·ÙŠØ±Ø§Ù†ØŸ", opts: ["Ù‡Ùˆ Ø¹Ù…Ù„ÙŠØ© Ø§Ù†ØªÙ‚Ø§Ù„ Ø§Ù„Ø£Ø¬Ø³Ø§Ù… ÙÙŠ Ø§Ù„Ù‡ÙˆØ§Ø¡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‚ÙˆÙ‰ Ø§Ù„Ø±ÙØ¹ ÙˆØ§Ù„Ø¯ÙØ¹", "Ù‡Ùˆ Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¨Ø±ÙŠ ÙÙ‚Ø·", "Ù‡Ùˆ Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¨Ø­Ø±ÙŠ ÙÙ‚Ø·", "Ù‡Ùˆ Ø§Ù„Ø³ÙØ± Ø¨Ø§Ù„Ù‚Ø·Ø§Ø±"], ans: 0 },
            { type: "ØªØ¹Ø±ÙŠÙ", q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø­Ø±ÙƒØ© Ø§Ù„Ø¬ÙˆÙŠØ© (ATC)ØŸ", opts: ["Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø·Ø§Ø¦Ø±Ø§Øª", "Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„ØªÙ†Ø¸ÙŠÙ… ÙˆØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø·Ø§Ø¦Ø±Ø§Øª Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø³Ù„Ø§Ù…Ø©", "Ù†Ù‚Ù„ Ø§Ù„Ø±ÙƒØ§Ø¨", "Ø¨ÙŠØ¹ Ø§Ù„ØªØ°Ø§ÙƒØ±"], ans: 1 },
            { type: "ØªØ¹Ø±ÙŠÙ", q: "Ù…Ø§ Ù‡Ùˆ ÙˆÙ‚ÙˆØ¯ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ù…Ø³ØªØ¯Ø§Ù… (SAF)ØŸ", opts: ["ÙˆÙ‚ÙˆØ¯ ØªÙ‚Ù„ÙŠØ¯ÙŠ", "Ù†ÙˆØ¹ Ù…Ù† Ø§Ù„ÙˆÙ‚ÙˆØ¯ Ø§Ù„ØµØ¯ÙŠÙ‚ Ù„Ù„Ø¨ÙŠØ¦Ø© ÙŠÙ‚Ù„Ù„ Ø§Ù†Ø¨Ø¹Ø§Ø«Ø§Øª Ø§Ù„ÙƒØ±Ø¨ÙˆÙ†", "Ø²ÙŠØª Ø¹Ø§Ø¯ÙŠ", "Ø¯ÙŠØ²Ù„"], ans: 1 },
            { type: "ØªØ¹Ø±ÙŠÙ", q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ù…Ø³ØªØ¯Ø§Ù…ØŸ", opts: ["Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ø³Ø±ÙŠØ¹ ÙÙ‚Ø·", "Ù…ÙÙ‡ÙˆÙ… ÙŠÙ‡Ø¯Ù Ø¥Ù„Ù‰ Ø¬Ø¹Ù„ Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø£ÙƒØ«Ø± ÙƒÙØ§Ø¡Ø© ÙˆØ£Ù‚Ù„ Ø¶Ø±Ø±Ù‹Ø§ Ù„Ù„Ø¨ÙŠØ¦Ø©", "Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ø«Ù‚ÙŠÙ„", "Ø§Ù„Ø·ÙŠØ±Ø§Ù† Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ"], ans: 1 },
            { type: "ØªØ¹Ø±ÙŠÙ", q: "Ù…Ù† Ù‡Ù… Ø§Ù„Ø£Ø®ÙˆØ§Ù† Ø±Ø§ÙŠØªØŸ", opts: ["Ù…ÙˆØ³ÙŠÙ‚ÙŠØ§Ù†", "Ø£ÙˆØ±ÙÙŠÙ„ ÙˆÙˆÙŠÙ„Ø¨Ø± Ø±Ø§ÙŠØªØŒ Ø£ÙˆÙ„ Ù…Ù† Ù†Ø¬Ø­ ÙÙŠ Ø±Ø­Ù„Ø© Ø·ÙŠØ±Ø§Ù† Ù…Ø¯ÙÙˆØ¹ Ø¹Ø§Ù… 1903", "Ø±Ø³Ø§Ù…Ø§Ù†", "ÙƒØ§ØªØ¨Ø§Ù†"], ans: 1 },
            { type: "ØªØ¹Ø±ÙŠÙ", q: "Ù…Ø§ Ù‡ÙŠ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒØ§ Ø§Ù„Ù‡ÙˆØ§Ø¡ ÙÙŠ Ø§Ù„Ø·ÙŠØ±Ø§Ù†ØŸ", opts: ["Ø¯Ø±Ø§Ø³Ø© Ø­Ø±ÙƒØ© Ø§Ù„Ø·Ø§Ø¦Ø±Ø§Øª", "Ø¯Ø±Ø§Ø³Ø© Ø­Ø±ÙƒØ© Ø§Ù„Ù‡ÙˆØ§Ø¡ ÙˆØªØ£Ø«ÙŠØ±Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø¬Ø³Ø§Ù… Ø§Ù„Ù…ØªØ­Ø±ÙƒØ©", "Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª", "Ø¯Ø±Ø§Ø³Ø© Ø§Ù„ÙˆÙ‚ÙˆØ¯"], ans: 1 },
            { type: "ØªØ¹Ø±ÙŠÙ", q: "Ù…Ø§ Ù…Ø¹Ù†Ù‰ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª Ø§Ù„Ø­Ø¯ÙŠØ«Ø© (Avionics) ÙÙŠ Ø§Ù„Ø·ÙŠØ±Ø§Ù†ØŸ", opts: ["Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ø·Ø§Ø¦Ø±Ø©", "Ø£Ù†Ø¸Ù…Ø© Ù…ØªÙ‚Ø¯Ù…Ø© Ù„ØªØ­Ø³ÙŠÙ† Ø³Ù„Ø§Ù…Ø© ÙˆÙ…Ù„Ø§Ø­Ø© Ø§Ù„Ø·Ø§Ø¦Ø±Ø©", "Ø§Ù„Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ù†ÙØ§Ø«Ø©", "Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ÙˆÙ‚ÙˆØ¯"], ans: 1 }
        ];
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let questions = [];
        let currentQuestion = 0;
        let score = 0;
        let correct = 0;
        let wrong = 0;
        let timeLeft = 1800;
        let timerInterval = null;
        let answered = false;
        let studentAnswers = [];
        let currentStudent = null;
        let currentEditIndex = null;
        
        // ØªØ®Ø²ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨
        let studentsData = JSON.parse(localStorage.getItem('studentsData')) || [];
        
        // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¯Ø±Ø³
        const teacherCredentials = {
            username: "teacher",
            password: "123456"
        };
        
        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªÙ†Ù‚Ù„
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ØµÙØ­Ø© Ø§Ù„Ù…Ø¯Ø±Ø³ØŒ Ù‚Ù… Ø¨ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (sectionId === 'teacherPanel') {
                updateTeacherPanel();
            }
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨
        function registerStudent() {
            const studentName = document.getElementById('studentName').value.trim();
            const examNumber = document.getElementById('examNumber').value;
            
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ Ø£ÙˆÙ„Ø§Ù‹
            document.getElementById('nameError').style.display = 'none';
            document.getElementById('numberError').style.display = 'none';
            document.getElementById('duplicateError').style.display = 'none';
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            let isValid = true;
            
            if (!studentName) {
                document.getElementById('nameError').style.display = 'block';
                isValid = false;
            }
            
            if (!examNumber || examNumber <= 0) {
                document.getElementById('numberError').style.display = 'block';
                isValid = false;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
            const isDuplicate = studentsData.some(student => student.examNumber == examNumber);
            if (isDuplicate) {
                document.getElementById('duplicateError').style.display = 'block';
                isValid = false;
            }
            
            if (!isValid) return;
            
            // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
            currentStudent = {
                name: studentName,
                examNumber: examNumber,
                startTime: new Date().toISOString()
            };
            
            // Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ ØµÙØ­Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
            document.getElementById('displayStudentName').textContent = studentName;
            document.getElementById('displayExamNumber').textContent = examNumber;
            document.getElementById('displayRegistrationTime').textContent = new Date().toLocaleString('ar-EG');
            
            // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª
            showSection('lesson');
        }
        
        // Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³
        function teacherLogin() {
            const username = document.getElementById('teacherUsername').value;
            const password = document.getElementById('teacherPassword').value;
            
            if (username === teacherCredentials.username && password === teacherCredentials.password) {
                showSection('teacherPanel');
            } else {
                alert('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        }
        
        // ØªØ­Ø¯ÙŠØ« Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø¯Ø±Ø³
        function updateTeacherPanel() {
            const studentList = document.getElementById('studentList');
            studentList.innerHTML = '';
            
            if (studentsData.length === 0) {
                studentList.innerHTML = '<div class="no-data">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø·Ù„Ø§Ø¨ Ø¨Ø¹Ø¯</div>';
                document.getElementById('totalStudents').textContent = '0';
                document.getElementById('averageScore').textContent = '0%';
                document.getElementById('highestScore').textContent = '0%';
                document.getElementById('lowestScore').textContent = '0%';
                return;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            document.getElementById('totalStudents').textContent = studentsData.length;
            
            const scores = studentsData.map(student => student.score || 0);
            const averageScore = scores.length > 0 ? scores.reduce((a, b) => a + b, 0) / scores.length : 0;
            document.getElementById('averageScore').textContent = Math.round(averageScore) + '%';
            document.getElementById('highestScore').textContent = scores.length > 0 ? Math.max(...scores) + '%' : '0%';
            document.getElementById('lowestScore').textContent = scores.length > 0 ? Math.min(...scores) + '%' : '0%';
            
            // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø§Ø¨
            studentsData.forEach((student, index) => {
                const studentCard = document.createElement('div');
                studentCard.className = 'student-card';
                
                studentCard.innerHTML = `
                    <h4>${student.name} (Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†: ${student.examNumber})</h4>
                    <p><strong>Ø§Ù„Ù†ØªÙŠØ¬Ø©:</strong> ${student.score || 0}%</p>
                    <p><strong>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©:</strong> ${student.correctAnswers || 0} Ù…Ù† 30</p>
                    <p><strong>Ø§Ù„ÙˆÙ‚Øª:</strong> ${student.timeTaken || '00:00'}</p>
                    <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</strong> ${student.endTime ? new Date(student.endTime).toLocaleString('ar-EG') : 'Ù„Ù… ÙŠÙƒÙ…Ù„'}</p>
                    <div class="student-actions">
                        <button class="btn-warning" onclick="editStudent(${index})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn-success" onclick="showStudentDetails(${index})">ğŸ“Š Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
                        <button class="btn-danger" onclick="confirmDelete(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </div>
                    <div id="studentDetails${index}" class="question-details" style="display: none;">
                        ${generateStudentDetails(student)}
                    </div>
                    <div id="editForm${index}" class="edit-form" style="display: none;">
                        ${generateEditForm(student, index)}
                    </div>
                `;
                
                studentList.appendChild(studentCard);
            });
        }
        
        // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ø§Ù„Ø¨
        function showStudentDetails(index) {
            const detailsElement = document.getElementById(`studentDetails${index}`);
            const editElement = document.getElementById(`editForm${index}`);
            
            if (detailsElement.style.display === 'none') {
                detailsElement.style.display = 'block';
                if (editElement) editElement.style.display = 'none';
            } else {
                detailsElement.style.display = 'none';
            }
        }
        
        // ØªÙˆÙ„ÙŠØ¯ ØªÙØ§ØµÙŠÙ„ Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
        function generateStudentDetails(student) {
            if (!student.answers || student.answers.length === 0) {
                return '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ ØªÙØ§ØµÙŠÙ„ Ù„Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</p>';
            }
            
            let html = '<h4>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª:</h4>';
            
            student.answers.forEach((answer, qIndex) => {
                const isCorrect = answer.correct;
                const selectedOption = answer.selectedOption || 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©';
                const correctOption = answer.correctOption || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                
                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø£ØµÙ„ÙŠ
                const originalQuestion = allQuestions[answer.originalIndex] || { q: 'Ø³Ø¤Ø§Ù„ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ' };
                
                html += `
                    <div class="question-result ${isCorrect ? 'correct' : 'incorrect'}">
                        <div class="question-text">Ø³ ${qIndex + 1}: ${originalQuestion.q}</div>
                        <p><strong>Ø¥Ø¬Ø§Ø¨ØªÙƒ:</strong> ${selectedOption}</p>
                        <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${isCorrect ? 'âœ… ØµØ­ÙŠØ­' : 'âŒ Ø®Ø·Ø£'}</p>
                        ${!isCorrect ? `<p><strong>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø©:</strong> ${correctOption}</p>` : ''}
                    </div>
                `;
            });
            
            return html;
        }
        
        // ØªÙˆÙ„ÙŠØ¯ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        function generateEditForm(student, index) {
            return `
                <h4>ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h4>
                <div class="form-group">
                    <label>Ø§Ù„Ø§Ø³Ù…:</label>
                    <input type="text" id="editName${index}" class="form-control" value="${student.name}">
                </div>
                <div class="form-group">
                    <label>Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†:</label>
                    <input type="number" id="editExamNumber${index}" class="form-control" value="${student.examNumber}">
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ù†ØªÙŠØ¬Ø© (%):</label>
                    <input type="number" id="editScore${index}" class="form-control" value="${student.score || 0}" min="0" max="100">
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª Ø§Ù„ØµØ­ÙŠØ­Ø©:</label>
                    <input type="number" id="editCorrect${index}" class="form-control" value="${student.correctAnswers || 0}" min="0" max="30">
                </div>
                <div class="student-actions">
                    <button class="btn-success" onclick="saveEdit(${index})">ğŸ’¾ Ø­ÙØ¸</button>
                    <button class="btn-secondary" onclick="cancelEdit(${index})">âŒ Ø¥Ù„ØºØ§Ø¡</button>
                </div>
            `;
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
        function editStudent(index) {
            const detailsElement = document.getElementById(`studentDetails${index}`);
            const editElement = document.getElementById(`editForm${index}`);
            
            if (detailsElement) detailsElement.style.display = 'none';
            if (editElement) editElement.style.display = 'block';
            currentEditIndex = index;
        }
        
        // Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
        function saveEdit(index) {
            const name = document.getElementById(`editName${index}`).value.trim();
            const examNumber = document.getElementById(`editExamNumber${index}`).value;
            const score = parseInt(document.getElementById(`editScore${index}`).value) || 0;
            const correctAnswers = parseInt(document.getElementById(`editCorrect${index}`).value) || 0;
            
            if (!name || !examNumber) {
                alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
            const isDuplicate = studentsData.some((student, i) => i !== index && student.examNumber == examNumber);
            if (isDuplicate) {
                alert('Ø±Ù‚Ù… Ø§Ù„Ø§Ù…ØªØ­Ø§Ù† Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹');
                return;
            }
            
            studentsData[index].name = name;
            studentsData[index].examNumber = examNumber;
            studentsData[index].score = score;
            studentsData[index].correctAnswers = correctAnswers;
            
            localStorage.setItem('studentsData', JSON.stringify(studentsData));
            updateTeacherPanel();
            
            alert('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
        }
        
        // Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        function cancelEdit(index) {
            const editElement = document.getElementById(`editForm${index}`);
            if (editElement) editElement.style.display = 'none';
            currentEditIndex = null;
        }
        
        // ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù
        function confirmDelete(index) {
            const student = studentsData[index];
            document.getElementById('modalTitle').textContent = 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø­Ø°Ù';
            document.getElementById('modalMessage').textContent = `Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨ ${student.name} (Ø±Ù‚Ù… ${student.examNumber})ØŸ`;
            document.getElementById('confirmAction').onclick = () => deleteStudent(index);
            document.getElementById('confirmModal').style.display = 'block';
        }
        
        // Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨
        function deleteStudent(index) {
            studentsData.splice(index, 1);
            localStorage.setItem('studentsData', JSON.stringify(studentsData));
            updateTeacherPanel();
            closeModal();
            alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
        }
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function exportData() {
            const dataStr = JSON.stringify(studentsData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'students_data.json';
            link.click();
            URL.revokeObjectURL(url);
        }
        
        // Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function clearAllData() {
            document.getElementById('modalTitle').textContent = 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø³Ø­';
            document.getElementById('modalMessage').textContent = 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ù‡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.';
            document.getElementById('confirmAction').onclick = performClearAll;
            document.getElementById('confirmModal').style.display = 'block';
        }
        
        function performClearAll() {
            studentsData = [];
            localStorage.setItem('studentsData', JSON.stringify(studentsData));
            updateTeacherPanel();
            closeModal();
            alert('ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
        }
        
        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
        function closeModal() {
            document.getElementById('confirmModal').style.display = 'none';
        }
        
        // ÙˆØ¸Ø§Ø¦Ù Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù„Ù„Ø£Ø³Ø¦Ù„Ø© ÙˆØ§Ù„Ø®ÙŠØ§Ø±Ø§Øª
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        
        function shuffleQuestionsAndOptions() {
            // Ù†Ø³Ø® Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
            const shuffledQuestions = shuffleArray([...allQuestions]);
            
            // Ø®Ù„Ø· Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ù„ÙƒÙ„ Ø³Ø¤Ø§Ù„
            shuffledQuestions.forEach(question => {
                // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
                const correctAnswer = question.opts[question.ans];
                
                // Ø®Ù„Ø· Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
                const shuffledOptions = shuffleArray([...question.opts]);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
                question.ans = shuffledOptions.indexOf(correctAnswer);
                question.opts = shuffledOptions;
            });
            
            return shuffledQuestions;
        }
        
        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†
        function goToStart() {
            showSection('startScreen');
        }
        
        function backToLesson() {
            showSection('lesson');
        }
        
        function startQuiz() {
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ø³Ø¬Ù„
            if (!currentStudent) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù‚Ø¨Ù„ Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†');
                showSection('studentRegistration');
                return;
            }
            
            // ØªÙˆÙ„ÙŠØ¯ Ø£Ø³Ø¦Ù„Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù„ÙƒÙ„ Ø·Ø§Ù„Ø¨
            questions = shuffleQuestionsAndOptions();
            currentQuestion = 0;
            score = 0;
            correct = 0;
            wrong = 0;
            timeLeft = 1800;
            answered = false;
            studentAnswers = [];
            
            showSection('quiz');
            
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimer();
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    endQuiz();
                }
            }, 1000);
            
            displayQuestion();
        }
        
        function updateTimer() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            const timerEl = document.getElementById('timer');
            timerEl.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            if (timeLeft <= 600) timerEl.classList.add('warning');
            if (timeLeft <= 60) {
                timerEl.classList.remove('warning');
                timerEl.classList.add('danger');
            }
        }
        
        function displayQuestion() {
            if (currentQuestion >= questions.length) {
                endQuiz();
                return;
            }
            
            answered = false;
            const q = questions[currentQuestion];
            const progressPercent = (currentQuestion / questions.length) * 100;
            
            document.getElementById('progressBar').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${currentQuestion + 1} Ù…Ù† ${questions.length}`;
            document.getElementById('currentScore').textContent = score.toFixed(1);
            
            let html = `<div class="quiz-question"><div class="question-type">${q.type}</div><h3>${q.q}</h3><div class="options">`;
            
            q.opts.forEach((opt, idx) => {
                html += `<div class="option" onclick="selectOpt(${idx})">${opt}</div>`;
            });
            
            html += `</div><div class="feedback" id="feedback"></div><div class="nav-buttons"><button class="btn-primary" id="nextBtn" onclick="nextQ()" disabled>Ø§Ù„ØªØ§Ù„ÙŠ</button></div></div>`;
            
            document.getElementById('quizContainer').innerHTML = html;
        }
        
        function selectOpt(idx) {
            if (answered) return;
            answered = true;
            
            const opts = document.querySelectorAll('.option');
            opts.forEach(o => o.classList.add('disabled'));
            
            const q = questions[currentQuestion];
            const feedback = document.getElementById('feedback');
            const nextBtn = document.getElementById('nextBtn');
            
            // Ø­ÙØ¸ Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ©
            const originalQuestionIndex = allQuestions.findIndex(originalQ => 
                originalQ.q === q.q && originalQ.type === q.type
            );
            
            studentAnswers.push({
                questionIndex: currentQuestion,
                selected: idx,
                correct: idx === q.ans,
                originalIndex: originalQuestionIndex,
                selectedOption: q.opts[idx],
                correctOption: q.opts[q.ans],
                correctAnswer: q.ans
            });
            
            if (idx === q.ans) {
                opts[idx].classList.add('correct');
                feedback.className = 'feedback show correct';
                feedback.innerHTML = 'âœ… ØµØ­ÙŠØ­!';
                score += 1;
                correct++;
            } else {
                opts[idx].classList.add('incorrect');
                opts[q.ans].classList.add('correct');
                feedback.className = 'feedback show incorrect';
                feedback.innerHTML = `âŒ Ø®Ø·Ø£! Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù‡ÙŠ: ${q.opts[q.ans]}`;
                score -= 0.5;
                wrong++;
            }
            
            document.getElementById('currentScore').textContent = score.toFixed(1);
            nextBtn.disabled = false;
        }
        
        function nextQ() {
            currentQuestion++;
            displayQuestion();
        }
        
        function endQuiz() {
            if (timerInterval) clearInterval(timerInterval);
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ÙƒÙ†Ø³Ø¨Ø© Ù…Ø¦ÙˆÙŠØ©
            const finalScore = Math.max(0, score);
            const percentage = Math.round((finalScore / 30) * 100);
            
            // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
            if (currentStudent) {
                const studentResult = {
                    ...currentStudent,
                    score: percentage,
                    correctAnswers: correct,
                    wrongAnswers: wrong,
                    finalScore: finalScore.toFixed(1),
                    timeTaken: formatTime(1800 - timeLeft),
                    endTime: new Date().toISOString(),
                    answers: studentAnswers,
                    questionsOrder: questions.map(q => allQuestions.findIndex(originalQ => 
                        originalQ.q === q.q && originalQ.type === q.type
                    ))
                };
                
                studentsData.push(studentResult);
                localStorage.setItem('studentsData', JSON.stringify(studentsData));
            }
            
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            
            document.getElementById('finalScore').textContent = `Ø¯Ø±Ø¬ØªÙƒ: ${finalScore.toFixed(1)} Ù…Ù† 30`;
            document.getElementById('scorePercentage').textContent = `Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ©: ${percentage}%`;
            document.getElementById('correctAnswers').textContent = correct;
            document.getElementById('wrongAnswers').textContent = wrong;
            document.getElementById('totalPoints').textContent = finalScore.toFixed(1);
            
            if (percentage >= 90) document.getElementById('resultTitle').innerHTML = 'ğŸ† Ù…Ù…ØªØ§Ø² Ø¬Ø¯Ø§Ù‹!';
            else if (percentage >= 80) document.getElementById('resultTitle').innerHTML = 'ğŸ–ï¸ Ù…Ù…ØªØ§Ø²!';
            else if (percentage >= 70) document.getElementById('resultTitle').innerHTML = 'ğŸ‘ Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹!';
            else if (percentage >= 60) document.getElementById('resultTitle').innerHTML = 'ğŸ‘Œ Ø¬ÙŠØ¯!';
            else document.getElementById('resultTitle').innerHTML = 'ğŸ’ª Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!';
        }
        
        // ÙˆØ¸ÙŠÙØ© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${minutes}:${secs.toString().padStart(2, '0')}`;
        }
    </script>
</body>
</html>
